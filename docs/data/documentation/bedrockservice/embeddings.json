{"kind":"article","seeAlsoSections":[{"anchor":"Related-Documentation","title":"Related Documentation","identifiers":["doc:\/\/BedrockService\/documentation\/BedrockService\/TextGeneration","doc:\/\/BedrockService\/documentation\/BedrockService\/Converse"]},{"identifiers":["doc:\/\/BedrockService\/documentation\/BedrockService\/Converse","doc:\/\/BedrockService\/documentation\/BedrockService\/ImageGeneration","doc:\/\/BedrockService\/documentation\/BedrockService\/TextGeneration"],"title":"Core Features","anchor":"Core-Features","generated":true}],"sections":[],"primaryContentSections":[{"content":[{"anchor":"Overview","type":"heading","text":"Overview","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"Embeddings convert text into numerical vector representations that capture semantic meaning. These vectors enable similarity comparisons, clustering, and retrieval-augmented generation (RAG) systems."}]},{"anchor":"Basic-Embeddings","type":"heading","level":2,"text":"Basic Embeddings"},{"inlineContent":[{"type":"text","text":"Generate embeddings from text:"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["let model: BedrockModel = .titan_embed_text_v2","","guard model.hasEmbeddingsModality() else {","    throw MyError.incorrectModality(\"\\(model.name) does not support embeddings\")","}","","let embeddings = try await bedrock.embed(","    \"Swift is a powerful programming language\",","    with: model",")","","print(\"Generated embeddings with \\(embeddings.count) dimensions\")","print(\"First few values: \\(Array(embeddings.prefix(5)))\")"]},{"type":"heading","text":"Vector Size Control","level":2,"anchor":"Vector-Size-Control"},{"inlineContent":[{"type":"text","text":"Specify the embedding vector size:"}],"type":"paragraph"},{"syntax":"swift","code":["let embeddings = try await bedrock.embed(","    \"Machine learning and artificial intelligence\",","    with: model,","    vectorSize: 512",")","","print(\"Embedding dimensions: \\(embeddings.count)\")"],"type":"codeListing"},{"type":"heading","text":"Semantic Similarity","level":2,"anchor":"Semantic-Similarity"},{"inlineContent":[{"text":"Compare text similarity using embeddings:","type":"text"}],"type":"paragraph"},{"code":["let text1 = \"The cat sat on the mat\"","let text2 = \"A feline rested on the rug\"","let text3 = \"Quantum computing uses qubits\"","","let embedding1 = try await bedrock.embed(text1, with: model)","let embedding2 = try await bedrock.embed(text2, with: model)","let embedding3 = try await bedrock.embed(text3, with: model)","","\/\/ Calculate cosine similarity","func cosineSimilarity(_ a: [Double], _ b: [Double]) -> Double {","    let dotProduct = zip(a, b).map(*).reduce(0, +)","    let magnitudeA = sqrt(a.map { $0 * $0 }.reduce(0, +))","    let magnitudeB = sqrt(b.map { $0 * $0 }.reduce(0, +))","    return dotProduct \/ (magnitudeA * magnitudeB)","}","","let similarity12 = cosineSimilarity(embedding1, embedding2)","let similarity13 = cosineSimilarity(embedding1, embedding3)","","print(\"Similarity between text1 and text2: \\(similarity12)\")","print(\"Similarity between text1 and text3: \\(similarity13)\")","\/\/ text1 and text2 should have higher similarity than text1 and text3"],"syntax":"swift","type":"codeListing"},{"text":"Batch Processing","level":2,"anchor":"Batch-Processing","type":"heading"},{"inlineContent":[{"text":"Process multiple texts efficiently:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["let texts = [","    \"Apple is a technology company\",","    \"Bananas are yellow fruits\", ","    \"Microsoft develops software\",","    \"Oranges are citrus fruits\",","    \"Google creates search engines\"","]","","var embeddings: [[Double]] = []","","for text in texts {","    let embedding = try await bedrock.embed(text, with: model)","    embeddings.append(embedding)","}","","\/\/ Find most similar texts","func findMostSimilar(to queryIndex: Int, in embeddings: [[Double]]) -> Int {","    var maxSimilarity = -1.0","    var mostSimilarIndex = 0","    ","    for (index, embedding) in embeddings.enumerated() {","        guard index != queryIndex else { continue }","        ","        let similarity = cosineSimilarity(embeddings[queryIndex], embedding)","        if similarity > maxSimilarity {","            maxSimilarity = similarity","            mostSimilarIndex = index","        }","    }","    ","    return mostSimilarIndex","}","","let queryIndex = 0 \/\/ \"Apple is a technology company\"","let similarIndex = findMostSimilar(to: queryIndex, in: embeddings)","print(\"Most similar to '\\(texts[queryIndex])': '\\(texts[similarIndex])'\")"],"type":"codeListing"},{"level":2,"anchor":"Document-Retrieval-System","text":"Document Retrieval System","type":"heading"},{"inlineContent":[{"text":"Build a simple RAG system:","type":"text"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["struct Document {","    let id: String","    let content: String","    let embedding: [Double]","}","","class DocumentStore {","    private var documents: [Document] = []","    private let bedrock: BedrockService","    private let model: BedrockModel","    ","    init(bedrock: BedrockService, model: BedrockModel) {","        self.bedrock = bedrock","        self.model = model","    }","    ","    func addDocument(_ content: String, id: String) async throws {","        let embedding = try await bedrock.embed(content, with: model)","        let document = Document(id: id, content: content, embedding: embedding)","        documents.append(document)","    }","    ","    func search(_ query: String, topK: Int = 3) async throws -> [Document] {","        let queryEmbedding = try await bedrock.embed(query, with: model)","        ","        let similarities = documents.map { doc in","            (doc, cosineSimilarity(queryEmbedding, doc.embedding))","        }","        ","        return similarities","            .sorted { $0.1 > $1.1 }","            .prefix(topK)","            .map { $0.0 }","    }","}","","\/\/ Usage","let store = DocumentStore(bedrock: bedrock, model: model)","","try await store.addDocument(\"Swift is a programming language developed by Apple\", id: \"doc1\")","try await store.addDocument(\"Python is popular for data science and machine learning\", id: \"doc2\")","try await store.addDocument(\"JavaScript runs in web browsers and Node.js\", id: \"doc3\")","","let results = try await store.search(\"Apple programming language\")","for doc in results {","    print(\"Found: \\(doc.content)\")","}"]},{"anchor":"Text-Clustering","type":"heading","text":"Text Clustering","level":2},{"inlineContent":[{"type":"text","text":"Group similar texts using embeddings:"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["struct TextCluster {","    let centroid: [Double]","    var texts: [String]","    var embeddings: [[Double]]","}","","func kMeansClustering(texts: [String], embeddings: [[Double]], k: Int, iterations: Int = 10) -> [TextCluster] {","    \/\/ Simple k-means implementation","    var clusters = Array(0..<k).map { _ in","        TextCluster(","            centroid: embeddings.randomElement()!,","            texts: [],","            embeddings: []","        )","    }","    ","    for _ in 0..<iterations {","        \/\/ Clear clusters","        for i in 0..<clusters.count {","            clusters[i].texts.removeAll()","            clusters[i].embeddings.removeAll()","        }","        ","        \/\/ Assign texts to nearest cluster","        for (textIndex, embedding) in embeddings.enumerated() {","            var minDistance = Double.infinity","            var nearestCluster = 0","            ","            for (clusterIndex, cluster) in clusters.enumerated() {","                let distance = 1.0 - cosineSimilarity(embedding, cluster.centroid)","                if distance < minDistance {","                    minDistance = distance","                    nearestCluster = clusterIndex","                }","            }","            ","            clusters[nearestCluster].texts.append(texts[textIndex])","            clusters[nearestCluster].embeddings.append(embedding)","        }","        ","        \/\/ Update centroids","        for i in 0..<clusters.count {","            if !clusters[i].embeddings.isEmpty {","                let dimensions = clusters[i].embeddings[0].count","                var newCentroid = Array(repeating: 0.0, count: dimensions)","                ","                for embedding in clusters[i].embeddings {","                    for j in 0..<dimensions {","                        newCentroid[j] += embedding[j]","                    }","                }","                ","                for j in 0..<dimensions {","                    newCentroid[j] \/= Double(clusters[i].embeddings.count)","                }","                ","                clusters[i] = TextCluster(","                    centroid: newCentroid,","                    texts: clusters[i].texts,","                    embeddings: clusters[i].embeddings","                )","            }","        }","    }","    ","    return clusters","}"]},{"type":"heading","text":"Model Capabilities","level":2,"anchor":"Model-Capabilities"},{"inlineContent":[{"type":"text","text":"Check embedding model features:"}],"type":"paragraph"},{"syntax":"swift","code":["if let embeddingModality = model.modality as? EmbeddingsModality {","    let params = embeddingModality.getEmbeddingsParameters()","    ","    if let vectorSizes = params.vectorSize.allowedValues {","        print(\"Supported vector sizes: \\(vectorSizes)\")","    }","    ","    print(\"Default vector size: \\(params.vectorSize.defaultValue)\")","}"],"type":"codeListing"},{"level":2,"anchor":"Use-Cases","text":"Use Cases","type":"heading"},{"inlineContent":[{"type":"text","text":"Embeddings are useful for:"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Semantic Search"}],"type":"strong"},{"type":"text","text":": Find documents similar to a query"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Recommendation Systems"}],"type":"strong"},{"type":"text","text":": Suggest similar content"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Text Classification"}],"type":"strong"},{"type":"text","text":": Group texts by topic"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Duplicate Detection"}],"type":"strong"},{"type":"text","text":": Find similar or duplicate content"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"RAG Systems"}],"type":"strong"},{"type":"text","text":": Retrieve relevant context for generation"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Clustering"}],"type":"strong"},{"type":"text","text":": Organize large text collections"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Anomaly Detection"}],"type":"strong"},{"type":"text","text":": Identify unusual text patterns"}],"type":"paragraph"}]}],"type":"unorderedList"}],"kind":"content"}],"schemaVersion":{"patch":0,"major":0,"minor":3},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/bedrockservice\/embeddings"]}],"hierarchy":{"paths":[["doc:\/\/BedrockService\/documentation\/BedrockService"]]},"metadata":{"title":"Embeddings","modules":[{"name":"BedrockService"}],"roleHeading":"Article","role":"article"},"identifier":{"url":"doc:\/\/BedrockService\/documentation\/BedrockService\/Embeddings","interfaceLanguage":"swift"},"abstract":[{"text":"Generate vector embeddings for semantic analysis","type":"text"}],"references":{"doc://BedrockService/documentation/BedrockService":{"url":"\/documentation\/bedrockservice","images":[{"identifier":"bedrock.png","type":"icon"}],"type":"topic","kind":"symbol","title":"BedrockService","abstract":[{"text":"A Swift library for interacting with Amazon Bedrock foundation models","type":"text"}],"role":"collection","identifier":"doc:\/\/BedrockService\/documentation\/BedrockService"},"doc://BedrockService/documentation/BedrockService/Converse":{"url":"\/documentation\/bedrockservice\/converse","type":"topic","kind":"article","role":"article","abstract":[{"type":"text","text":"Build conversational AI applications with the Converse API"}],"identifier":"doc:\/\/BedrockService\/documentation\/BedrockService\/Converse","title":"Converse API"},"doc://BedrockService/documentation/BedrockService/TextGeneration":{"url":"\/documentation\/bedrockservice\/textgeneration","title":"Text Generation","kind":"article","abstract":[{"text":"Generate text using the InvokeModel API","type":"text"}],"role":"article","identifier":"doc:\/\/BedrockService\/documentation\/BedrockService\/TextGeneration","type":"topic"},"doc://BedrockService/documentation/BedrockService/ImageGeneration":{"url":"\/documentation\/bedrockservice\/imagegeneration","type":"topic","kind":"article","role":"article","abstract":[{"type":"text","text":"Create and modify images with foundation models"}],"identifier":"doc:\/\/BedrockService\/documentation\/BedrockService\/ImageGeneration","title":"Image Generation"},"bedrock.png":{"alt":"BedrockService","variants":[{"url":"\/images\/BedrockService\/bedrock.png","traits":["1x","light"]}],"identifier":"bedrock.png","type":"image"}}}